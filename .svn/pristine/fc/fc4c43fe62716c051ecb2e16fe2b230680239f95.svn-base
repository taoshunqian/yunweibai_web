var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,o)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,__spreadValues=(e,t)=>{for(var o in t||(t={}))__hasOwnProp.call(t,o)&&__defNormalProp(e,o,t[o]);if(__getOwnPropSymbols)for(var o of __getOwnPropSymbols(t))__propIsEnum.call(t,o)&&__defNormalProp(e,o,t[o]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__async=(e,t,o)=>new Promise(((s,a)=>{var r=e=>{try{i(o.next(e))}catch(t){a(t)}},n=e=>{try{i(o.throw(e))}catch(t){a(t)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,n);i((o=o.apply(e,t)).next())}));import{bU as request,al as commonjsGlobal,bI as delete_default,b_ as copy_document_default,b$ as download_default,c0 as promotion_default,ae as loading_default,c1 as expand_default,b7 as plus_default,bR as useMainStore,c2 as copyText,c3 as timeFormat}from"./index-d257c50e.js";import{V as VMdPreview}from"./VMdPreview-c34aa559.js";import{ay as useRouter,aB as useRoute,a as reactive,aC as onBeforeRouteUpdate,f as toRefs,j as resolveComponent,ao as resolveDirective,K as withDirectives,k as openBlock,D as createElementBlock,E as createBaseVNode,Q as createVNode,J as withCtx,M as createCommentVNode,O as toDisplayString,l as createBlock,N as createTextVNode,G as normalizeClass,P as Fragment,a5 as renderList,n as nextTick,g as getCurrentInstance,az as pushScopeId,aA as popScopeId,A as watchEffect,a7 as withModifiers}from"./vue-9f93bd51.js";import{_ as _export_sfc,b as baseURL}from"./baseURL-7658c321.js";import"./pinia-047b13b6.js";import"./axios-49db6d97.js";const GetChatList=e=>request.get("/chats/list"),DeleteChats=e=>request.post("/chats/delete",e),GetMessageList=e=>request.get(`/chats/messages/${e.conversation_id}`),deleteMessage=e=>request.post("/message/delete",e);var sha256Exports={},sha256$1={get exports(){return sha256Exports},set exports(e){sha256Exports=e}};(function(module){(function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(o){return new Sha256(t,!0).update(o)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var o=0;o<OUTPUT_TYPES.length;++o){var s=OUTPUT_TYPES[o];t[s]=createOutputMethod(s,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(o,s){return new HmacSha256(o,t,!0).update(s)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,o){return t.create(e).update(o)};for(var o=0;o<OUTPUT_TYPES.length;++o){var s=OUTPUT_TYPES[o];t[s]=createHmacOutputMethod(s,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,o){var s,a=typeof e;if("string"===a){var r,n=[],i=e.length,l=0;for(s=0;s<i;++s)(r=e.charCodeAt(s))<128?n[l++]=r:r<2048?(n[l++]=192|r>>6,n[l++]=128|63&r):r<55296||r>=57344?(n[l++]=224|r>>12,n[l++]=128|r>>6&63,n[l++]=128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++s)),n[l++]=240|r>>18,n[l++]=128|r>>12&63,n[l++]=128|r>>6&63,n[l++]=128|63&r);e=n}else{if("object"!==a)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var c=[],d=[];for(s=0;s<64;++s){var h=e[s]||0;c[s]=92^h,d[s]=54^h}Sha256.call(this,t,o),this.update(d),this.oKeyPad=c,this.inner=!0,this.sharedMemory=o}Sha256.prototype.update=function(e){if(!this.finalized){var t,o=typeof e;if("string"!==o){if("object"!==o)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var s,a,r=0,n=e.length,i=this.blocks;r<n;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<n&&a<64;++r)i[a>>2]|=e[r]<<SHIFT[3&a++];else for(a=this.start;r<n&&a<64;++r)(s=e.charCodeAt(r))<128?i[a>>2]|=s<<SHIFT[3&a++]:s<2048?(i[a>>2]|=(192|s>>6)<<SHIFT[3&a++],i[a>>2]|=(128|63&s)<<SHIFT[3&a++]):s<55296||s>=57344?(i[a>>2]|=(224|s>>12)<<SHIFT[3&a++],i[a>>2]|=(128|s>>6&63)<<SHIFT[3&a++],i[a>>2]|=(128|63&s)<<SHIFT[3&a++]):(s=65536+((1023&s)<<10|1023&e.charCodeAt(++r)),i[a>>2]|=(240|s>>18)<<SHIFT[3&a++],i[a>>2]|=(128|s>>12&63)<<SHIFT[3&a++],i[a>>2]|=(128|s>>6&63)<<SHIFT[3&a++],i[a>>2]|=(128|63&s)<<SHIFT[3&a++]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,o,s,a,r,n,i,l,c=this.h0,d=this.h1,h=this.h2,u=this.h3,p=this.h4,_=this.h5,f=this.h6,m=this.h7,y=this.blocks;for(e=16;e<64;++e)t=((a=y[e-15])>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,o=((a=y[e-2])>>>17|a<<15)^(a>>>19|a<<13)^a>>>10,y[e]=y[e-16]+t+y[e-7]+o<<0;for(l=d&h,e=0;e<64;e+=4)this.first?(this.is224?(r=300032,m=(a=y[0]-1413257819)-150054599<<0,u=a+24177077<<0):(r=704751109,m=(a=y[0]-210244248)-1521486534<<0,u=a+143694565<<0),this.first=!1):(t=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),s=(r=c&d)^c&h^l,m=u+(a=m+(o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&_^~p&f)+K[e]+y[e])<<0,u=a+(t+s)<<0),t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),s=(n=u&c)^u&d^r,f=h+(a=f+(o=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&p^~m&_)+K[e+1]+y[e+1])<<0,t=((h=a+(t+s)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),s=(i=h&u)^h&c^n,_=d+(a=_+(o=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&m^~f&p)+K[e+2]+y[e+2])<<0,t=((d=a+(t+s)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),s=(l=d&h)^d&u^i,p=c+(a=p+(o=(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&f^~_&m)+K[e+3]+y[e+3])<<0,c=a+(t+s)<<0;this.h0=this.h0+c<<0,this.h1=this.h1+d<<0,this.h2=this.h2+h<<0,this.h3=this.h3+u<<0,this.h4=this.h4+p<<0,this.h5=this.h5+_<<0,this.h6=this.h6+f<<0,this.h7=this.h7+m<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,o=this.h2,s=this.h3,a=this.h4,r=this.h5,n=this.h6,i=this.h7,l=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n];return this.is224||(l+=HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]),l},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,o=this.h2,s=this.h3,a=this.h4,r=this.h5,n=this.h6,i=this.h7,l=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,o>>24&255,o>>16&255,o>>8&255,255&o,s>>24&255,s>>16&255,s>>8&255,255&s,a>>24&255,a>>16&255,a>>8&255,255&a,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n];return this.is224||l.push(i>>24&255,i>>16&255,i>>8&255,255&i),l},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256$1);const sha256=sha256Exports,md5=e=>sha256.sha256(e),buildHeader=e=>({Authorization:localStorage.getItem("token"),"x-sendData":e.params,"x-sign":md5(e.params+e.uid)});var eventsourceExports={},eventsource={get exports(){return eventsourceExports},set exports(e){eventsourceExports=e}},module,exports;module=eventsource,exports=eventsourceExports,function(e){var t=e.setTimeout,o=e.clearTimeout,s=e.XMLHttpRequest,a=e.XDomainRequest,r=e.ActiveXObject,n=e.EventSource,i=e.document,l=e.Promise,c=e.fetch,d=e.Response,h=e.TextDecoder,u=e.TextEncoder,p=e.AbortController;if("undefined"==typeof window||void 0===i||"readyState"in i||null!=i.body||(i.readyState="loading",window.addEventListener("load",(function(e){i.readyState="complete"}),!1)),null==s&&null!=r&&(s=function(){return new r("Microsoft.XMLHTTP")}),null==Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),Date.now||(Date.now=function(){return(new Date).getTime()}),null==p){var _=c;c=function(e,t){var o=t.signal;return _(e,{headers:t.headers,credentials:t.credentials,cache:t.cache}).then((function(e){var t=e.body.getReader();return o._reader=t,o._aborted&&o._reader.cancel(),{status:e.status,statusText:e.statusText,headers:e.headers,body:{getReader:function(){return t}}}}))},p=function(){this.signal={_reader:null,_aborted:!1},this.abort=function(){null!=this.signal._reader&&this.signal._reader.cancel(),this.signal._aborted=!0}}}function f(){this.bitsNeeded=0,this.codePoint=0}f.prototype.decode=function(e){function t(e,t,o){if(1===o)return e>=128>>t&&e<<t<=2047;if(2===o)return e>=2048>>t&&e<<t<=55295||e>=57344>>t&&e<<t<=65535;if(3===o)return e>=65536>>t&&e<<t<=1114111;throw new Error}function o(e,t){if(6===e)return t>>6>15?3:t>31?2:1;if(12===e)return t>15?3:2;if(18===e)return 3;throw new Error}for(var s=65533,a="",r=this.bitsNeeded,n=this.codePoint,i=0;i<e.length;i+=1){var l=e[i];0!==r&&(l<128||l>191||!t(n<<6|63&l,r-6,o(r,n)))&&(r=0,n=s,a+=String.fromCharCode(n)),0===r?(l>=0&&l<=127?(r=0,n=l):l>=192&&l<=223?(r=6,n=31&l):l>=224&&l<=239?(r=12,n=15&l):l>=240&&l<=247?(r=18,n=7&l):(r=0,n=s),0===r||t(n,r,o(r,n))||(r=0,n=s)):(r-=6,n=n<<6|63&l),0===r&&(n<=65535?a+=String.fromCharCode(n):(a+=String.fromCharCode(55296+(n-65535-1>>10)),a+=String.fromCharCode(56320+(n-65535-1&1023))))}return this.bitsNeeded=r,this.codePoint=n,a},null!=h&&null!=u&&function(){try{return"test"===(new h).decode((new u).encode("test"),{stream:!0})}catch(P){}return!1}()||(h=f);var m=function(){};function y(e){this.withCredentials=!1,this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=m,this.onload=m,this.onerror=m,this.onreadystatechange=m,this._contentType="",this._xhr=e,this._sendTimeout=0,this._abort=m}function v(e){return e.replace(/[A-Z]/g,(function(e){return String.fromCharCode(e.charCodeAt(0)+32)}))}function C(e){for(var t=Object.create(null),o=e.split("\r\n"),s=0;s<o.length;s+=1){var a=o[s].split(": "),r=a.shift(),n=a.join(": ");t[v(r)]=n}this._map=t}function w(){}function g(e){this._headers=e}function S(){}function x(){this._listeners=Object.create(null)}function E(e){t((function(){throw e}),0)}function b(e){this.type=e,this.target=void 0}function H(e,t){b.call(this,e),this.data=t.data,this.lastEventId=t.lastEventId}function R(e,t){b.call(this,e),this.status=t.status,this.statusText=t.statusText,this.headers=t.headers}function A(e,t){b.call(this,e),this.error=t.error}y.prototype.open=function(e,a){this._abort(!0);var r=this,n=this._xhr,i=1,l=0;this._abort=function(e){0!==r._sendTimeout&&(o(r._sendTimeout),r._sendTimeout=0),1!==i&&2!==i&&3!==i||(i=4,n.onload=m,n.onerror=m,n.onabort=m,n.onprogress=m,n.onreadystatechange=m,n.abort(),0!==l&&(o(l),l=0),e||(r.readyState=4,r.onabort(null),r.onreadystatechange())),i=0};var c=function(){if(1===i){var e=0,t="",o=void 0;if("contentType"in n)e=200,t="OK",o=n.contentType;else try{e=n.status,t=n.statusText,o=n.getResponseHeader("Content-Type")}catch(s){e=0,t="",o=void 0}0!==e&&(i=2,r.readyState=2,r.status=e,r.statusText=t,r._contentType=o,r.onreadystatechange())}},d=function(){if(c(),2===i||3===i){i=3;var e="";try{e=n.responseText}catch(t){}r.readyState=3,r.responseText=e,r.onprogress()}},h=function(e,t){if(null!=t&&null!=t.preventDefault||(t={preventDefault:m}),d(),1===i||2===i||3===i){if(i=4,0!==l&&(o(l),l=0),r.readyState=4,"load"===e)r.onload(t);else if("error"===e)r.onerror(t);else{if("abort"!==e)throw new TypeError;r.onabort(t)}r.onreadystatechange()}},u=function(){l=t((function(){u()}),500),3===n.readyState&&d()};"onload"in n&&(n.onload=function(e){h("load",e)}),"onerror"in n&&(n.onerror=function(e){h("error",e)}),"onabort"in n&&(n.onabort=function(e){h("abort",e)}),"onprogress"in n&&(n.onprogress=d),"onreadystatechange"in n&&(n.onreadystatechange=function(e){var t;t=e,null!=n&&(4===n.readyState?"onload"in n&&"onerror"in n&&"onabort"in n||h(""===n.responseText?"error":"load",t):3===n.readyState?"onprogress"in n||d():2===n.readyState&&c())}),!("contentType"in n)&&"ontimeout"in s.prototype||(a+=(-1===a.indexOf("?")?"?":"&")+"padding=true"),n.open(e,a,!0),"readyState"in n&&(l=t((function(){u()}),0))},y.prototype.abort=function(){this._abort(!1)},y.prototype.getResponseHeader=function(e){return this._contentType},y.prototype.setRequestHeader=function(e,t){var o=this._xhr;"setRequestHeader"in o&&o.setRequestHeader(e,t)},y.prototype.getAllResponseHeaders=function(){return null!=this._xhr.getAllResponseHeaders&&this._xhr.getAllResponseHeaders()||""},y.prototype.send=function(){if("ontimeout"in s.prototype&&("sendAsBinary"in s.prototype||"mozAnon"in s.prototype)||null==i||null==i.readyState||"complete"===i.readyState){var e=this._xhr;"withCredentials"in e&&(e.withCredentials=this.withCredentials);try{e.send(void 0)}catch(a){throw a}}else{var o=this;o._sendTimeout=t((function(){o._sendTimeout=0,o.send()}),4)}},C.prototype.get=function(e){return this._map[v(e)]},null!=s&&null==s.HEADERS_RECEIVED&&(s.HEADERS_RECEIVED=2),w.prototype.open=function(e,t,o,a,r,n,i){e.open("GET",r);var l=0;for(var c in e.onprogress=function(){var t=e.responseText.slice(l);l+=t.length,o(t)},e.onerror=function(e){e.preventDefault(),a(new Error("NetworkError"))},e.onload=function(){a(null)},e.onabort=function(){a(null)},e.onreadystatechange=function(){if(e.readyState===s.HEADERS_RECEIVED){var o=e.status,a=e.statusText,r=e.getResponseHeader("Content-Type"),n=e.getAllResponseHeaders();t(o,a,r,new C(n))}},e.withCredentials=n,i)Object.prototype.hasOwnProperty.call(i,c)&&e.setRequestHeader(c,i[c]);return e.send(),e},g.prototype.get=function(e){return this._headers.get(e)},S.prototype.open=function(e,t,o,s,a,r,n){var i=null,d=new p,u=d.signal,_=new h;return c(a,{headers:n,credentials:r?"include":"same-origin",signal:u,cache:"no-store"}).then((function(e){return i=e.body.getReader(),t(e.status,e.statusText,e.headers.get("Content-Type"),new g(e.headers)),new l((function(e,t){var s=function(){i.read().then((function(t){if(t.done)e(void 0);else{var a=_.decode(t.value,{stream:!0});o(a),s()}})).catch((function(e){t(e)}))};s()}))})).catch((function(e){return"AbortError"===e.name?void 0:e})).then((function(e){s(e)})),{abort:function(){null!=i&&i.cancel(),d.abort()}}},x.prototype.dispatchEvent=function(e){e.target=this;var t=this._listeners[e.type];if(null!=t)for(var o=t.length,s=0;s<o;s+=1){var a=t[s];try{"function"==typeof a.handleEvent?a.handleEvent(e):a.call(this,e)}catch(r){E(r)}}},x.prototype.addEventListener=function(e,t){e=String(e);var o=this._listeners,s=o[e];null==s&&(s=[],o[e]=s);for(var a=!1,r=0;r<s.length;r+=1)s[r]===t&&(a=!0);a||s.push(t)},x.prototype.removeEventListener=function(e,t){e=String(e);var o=this._listeners,s=o[e];if(null!=s){for(var a=[],r=0;r<s.length;r+=1)s[r]!==t&&a.push(s[r]);0===a.length?delete o[e]:o[e]=a}},H.prototype=Object.create(b.prototype),R.prototype=Object.create(b.prototype),A.prototype=Object.create(b.prototype);var k=0,B=1,N=2,V=/^text\/event\-stream(;.*)?$/i,I=function(e,t){var o=null==e?t:parseInt(e,10);return o!=o&&(o=t),T(o)},T=function(e){return Math.min(Math.max(e,1e3),18e6)},O=function(e,t,o){try{"function"==typeof t&&t.call(e,o)}catch(s){E(s)}};function X(e,r){x.call(this),r=r||{},this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,this.url=void 0,this.readyState=void 0,this.withCredentials=void 0,this.headers=void 0,this._close=void 0,function(e,r,n){r=String(r);var i=Boolean(n.withCredentials),l=n.lastEventIdQueryParameterName||"lastEventId",c=T(1e3),d=I(n.heartbeatTimeout,45e3),h="",u=c,p=!1,_=0,f=n.headers||{},m=n.Transport,v=$&&null==m?void 0:new y(null!=m?new m:null!=s&&"withCredentials"in s.prototype||null==a?new s:new a),C=null!=m&&"string"!=typeof m?new m:null==v?new S:new w,g=void 0,x=0,E=-1,b="",X="",D="",P="",M=0,L=0,F=0,j=function(t,o,s,a){if(E===k)if(200===t&&null!=s&&V.test(s)){E=B,p=Date.now(),u=c,e.readyState=B;var r=new R("open",{status:t,statusText:o,headers:a});e.dispatchEvent(r),O(e,e.onopen,r)}else 200!==t?o&&(o=o.replace(/\s+/g," ")):null==s||s.replace(/\s+/g," "),K(),r=new R("error",{status:t,statusText:o,headers:a}),e.dispatchEvent(r),O(e,e.onerror,r)},U=function(s){if(E===B){for(var a=-1,r=0;r<s.length;r+=1)(l=s.charCodeAt(r))!=="\n".charCodeAt(0)&&l!=="\r".charCodeAt(0)||(a=r);var n=(-1!==a?P:"")+s.slice(0,a+1);P=(-1===a?P:"")+s.slice(a+1),""!==s&&(p=Date.now(),_+=s.length);for(var i=0;i<n.length;i+=1){var l=n.charCodeAt(i);if(-1===M&&l==="\n".charCodeAt(0))M=0;else if(-1===M&&(M=0),l==="\r".charCodeAt(0)||l==="\n".charCodeAt(0)){if(0!==M){1===M&&(F=i+1);var f=n.slice(L,F-1),m=n.slice(F+(F<i&&n.charCodeAt(F)===" ".charCodeAt(0)?1:0),i);"data"===f?(b+="\n",b+=m):"id"===f?X=m:"event"===f?D=m:"retry"===f?(c=I(m,c),u=c):"heartbeatTimeout"===f&&(d=I(m,d),0!==x&&(o(x),x=t((function(){J()}),d)))}if(0===M){if(""!==b){h=X,""===D&&(D="message");var y=new H(D,{data:b.slice(1),lastEventId:X});if(e.dispatchEvent(y),"open"===D?O(e,e.onopen,y):"message"===D?O(e,e.onmessage,y):"error"===D&&O(e,e.onerror,y),E===N)return}b="",D=""}M=l==="\r".charCodeAt(0)?-1:0}else 0===M&&(L=i,M=1),1===M?l===":".charCodeAt(0)&&(F=i+1,M=2):2===M&&(M=3)}}},z=function(s){if(E===B||E===k){E=-1,0!==x&&(o(x),x=0),x=t((function(){J()}),u),u=T(Math.min(16*c,2*u)),e.readyState=k;var a=new A("error",{error:s});e.dispatchEvent(a),O(e,e.onerror,a)}},K=function(){E=N,null!=g&&(g.abort(),g=void 0),0!==x&&(o(x),x=0),e.readyState=N},J=function(){if(x=0,-1===E){p=!1,_=0,x=t((function(){J()}),d),E=k,b="",D="",X=h,P="",L=0,F=0,M=0;var o=r;if("data:"!==r.slice(0,5)&&"blob:"!==r.slice(0,5)&&""!==h){var s=r.indexOf("?");o=-1===s?r:r.slice(0,s+1)+r.slice(s+1).replace(/(?:^|&)([^=&]*)(?:=[^&]*)?/g,(function(e,t){return t===l?"":e})),o+=(-1===r.indexOf("?")?"?":"&")+l+"="+encodeURIComponent(h)}var a=e.withCredentials,n={Accept:"text/event-stream"},i=e.headers;if(null!=i)for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(n[c]=i[c]);try{g=C.open(v,j,U,z,o,a,n)}catch(f){throw K(),f}}else if(p||null==g){var u=Math.max((p||Date.now())+d-Date.now(),1);p=!1,x=t((function(){J()}),u)}else z(new Error("No activity within "+d+" milliseconds. "+(E===k?"No response received.":_+" chars received.")+" Reconnecting.")),null!=g&&(g.abort(),g=void 0)};e.url=r,e.readyState=k,e.withCredentials=i,e.headers=f,e._close=K,J()}(this,e,r)}var $=null!=c&&null!=d&&"body"in d.prototype;X.prototype=Object.create(x.prototype),X.prototype.CONNECTING=k,X.prototype.OPEN=B,X.prototype.CLOSED=N,X.prototype.close=function(){this._close()},X.CONNECTING=k,X.OPEN=B,X.CLOSED=N,X.prototype.withCredentials=void 0;var D,P,M=n;null==s||null!=n&&"withCredentials"in n.prototype||(M=X),(P=exports).EventSourcePolyfill=X,P.NativeEventSource=n,void 0!==(D=void(P.EventSource=M))&&(module.exports=D)}("undefined"==typeof globalThis?"undefined"!=typeof window?window:"undefined"!=typeof self?self:commonjsGlobal:globalThis);const ChatContent_vue_vue_type_style_index_0_scoped_491950a7_lang="",_sfc_main$2={name:"ChatContent",components:{Delete:delete_default,CopyDocument:copy_document_default,Download:download_default,VMdPreview:VMdPreview,Promotion:promotion_default,Loading:loading_default,Expand:expand_default,Plus:plus_default},setup(e,t){const{proxy:o}=getCurrentInstance(),s=useRouter(),a=useRoute(),r=useMainStore(),n=reactive({needJump:!1,pageLoading:!1,chatKey:a.params.id,sendForm:{sendMessage:""},disabledInput:!1,chatInfo:{title:"鏂扮獥鍙ｄ細璇�",chat_role:0},messageList:[]}),i=()=>{n.chatKey&&"new"!==n.chatKey&&r.userInfo.role?(()=>{__async(this,null,(function*(){const e=yield GetMessageList({conversation_id:n.chatKey});200===e.statusCode&&(n.messageList=e.data,n.chatInfo={title:e.title,chat_role:e.chat_role},l()),n.pageLoading=!1}))})():n.chatKey&&"new"!==n.chatKey&&!r.userInfo.role&&s.replace(`/${a.params.device}/chat/new`)};i(),onBeforeRouteUpdate(((e,t,o)=>{n.chatKey=e.params.id,n.needJump?n.needJump=!1:(n.chatInfo.chat_role=0,n.messageList=[],i()),o()}));const l=()=>{nextTick((()=>{const e=o.$refs.scrollbarRef,t=e.$el.querySelector(".el-scrollbar__view").scrollHeight;e.scrollTo(0,t)}))},c=e=>__async(this,null,(function*(){if("done"===e.data)return n.eventStream.close(),window.is_sending=!1,n.disabledInput=!1,!1;let o=JSON.parse(e.data);o.conversationId&&"newChat"===n.chatKey?(n.chatKey=o.conversationId,n.chatInfo.title=n.messageList[0].content,yield s.replace(`/${a.params.device}/chat/${n.chatKey}`),t.emit("reloadList")):o.sendId||o.resId?(n.messageList[n.messageList.length-1].id=o.resId,n.messageList[n.messageList.length-2].id=o.sendId):o.conversationId||(n.messageList[n.messageList.length-1].content+=o.content,l())})),d=e=>{n.eventStream.close(),window.is_sending=!1,n.messageList[n.messageList.length-1].messageError=e.data||"缃戠粶寮傚父",n.disabledInput=!1},h=()=>__async(this,null,(function*(){if(n.disabledInput||!n.sendForm.sendMessage.trim())return!1;n.disabledInput=!0,window.is_sending=!0;const e=JSON.stringify({message:encodeURIComponent(n.sendForm.sendMessage),conversationId:n.chatKey&&"new"!==n.chatKey?n.chatKey:"",chat_role:n.chatInfo.chat_role}),t=buildHeader({params:e,uid:r.userInfo.uid});n.chatKey&&"new"!==n.chatKey||(n.chatKey="newChat",n.needJump=!0),n.messageList.push({role:"user",content:n.sendForm.sendMessage,sendTime:+new Date},{content:"",role:"assistant",messageError:"",sendTime:+new Date}),l(),n.sendForm.sendMessage="",n.eventStream=new eventsourceExports.EventSourcePolyfill(`${baseURL}/message/accomplish`,{headers:__spreadValues({},t)}),n.eventStream.onmessage=c,n.eventStream.onerror=d}));return __spreadProps(__spreadValues({copyText:copyText,mainStore:r,timeFormat:timeFormat},toRefs(n)),{ScrollToBottom:l,handleSubmit:h,reloadPage:()=>location.reload(),exportFile:(e,t)=>{r.waitSending((()=>{if(r.userInfo.isPay){const o=r.roleList[n.chatInfo.chat_role].name;let s="";"json"===e?s=JSON.stringify(n.messageList,null,2):n.messageList.forEach((e=>{const t="user"===e.role?e.role:o,a=timeFormat(e.sendTime);s+=`## ${t} ${a} ##\n\n${e.content}\n\n`}));let a=`data:${t};charset=utf-8,${encodeURIComponent(s)}`;const i=document.createElement("a");i.setAttribute("href",a);const l=n.chatInfo.title||"messages";i.setAttribute("download",`${l}.${e}`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}}))},handleKeyDown:e=>{e.shiftKey||13!==e.keyCode||(e.preventDefault(),h())},handleDeleteMessage:(e,t)=>{o.$confirm("纭瑕佸垹闄ゆ鏉℃秷鎭悧锛�","鍒犻櫎娑堟伅",{type:"error"}).then((()=>__async(this,null,(function*(){e?200===(yield deleteMessage({id:[e]})).statusCode&&(o.$message.success("鍒犻櫎鎴愬姛"),n.messageList.splice(t,1)):n.messageList.splice(t,1)}))))},handleStop:()=>{n.eventStream&&n.eventStream.close(),n.disabledInput=!1,window.is_sending=!1}})}},_withScopeId=e=>(pushScopeId("data-v-491950a7"),e=e(),popScopeId(),e),_hoisted_1$2={class:"chat-container","element-loading-background":"transparent"},_hoisted_2$1={class:"chat-content-title-box"},_hoisted_3$1={class:"chat-content-title max-w-[1000px] w-[90%] m-auto"},_hoisted_4$1={key:0,class:"left-icon-box"},_hoisted_5$1={class:"w-[50%] overflow-hidden m-auto text-ellipsis whitespace-nowrap"},_hoisted_6={class:"right-icon-box"},_hoisted_7={key:0,class:"chat-new-box overflow-hidden flex flex-col"},_hoisted_8={class:"max-w-[1000px] w-[90%] m-auto"},_hoisted_9={class:"flex justify-center w-full"},_hoisted_10=["onClick"],_hoisted_11=["src"],_hoisted_12={class:"role-name"},_hoisted_13={key:1,class:"chat-content-message-box"},_hoisted_14={class:"message-list max-w-[1000px] w-[90%] m-auto"},_hoisted_15=["src"],_hoisted_16=["src"],_hoisted_17={class:"message-preview"},_hoisted_18={class:"text-[14px]"},_hoisted_19={class:"message-preview-and-copy flex"},_hoisted_20={class:"message-preview-box"},_hoisted_21={key:0},_hoisted_22={key:0},_hoisted_23=_withScopeId((()=>createBaseVNode("span",{class:"inline-block ml-[5px]"},"姝ｅ湪鎬濊€�",-1))),_hoisted_24={key:1},_hoisted_25={key:0},_hoisted_26=_withScopeId((()=>createBaseVNode("div",null,"鎮ㄩ渶瑕佺櫥闄嗗悗杩涜浣跨敤~",-1))),_hoisted_27={key:1},_hoisted_28=_withScopeId((()=>createBaseVNode("div",null,"浠婃棩鍏嶈垂娆℃暟宸茬敤瀹岋紝寮€閫氫細鍛樼珛鍒荤晠浜紒",-1))),_hoisted_29={key:2},_hoisted_30=_withScopeId((()=>createBaseVNode("div",null,"椤甸潰杩囨湡锛岃鍒锋柊閲嶈瘯",-1))),_hoisted_31={key:3},_hoisted_32={class:"flex flex-col justify-end"},_hoisted_33=["onClick"],_hoisted_34=["onClick"],_hoisted_35=_withScopeId((()=>createBaseVNode("svg",{t:"1681983166203",class:"icon",viewBox:"0 0 1099 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2620",width:"200",height:"200"},[createBaseVNode("path",{d:"M867.84 501.248c0 168.448-136.704 304.64-304.64 304.64s-304.64-136.704-304.64-304.64S394.752 196.608 563.2 196.608 867.84 333.312 867.84 501.248zM563.2 231.936c-148.992 0-269.312 120.832-269.312 269.312s120.832 269.312 269.312 269.312 269.312-120.832 269.312-269.312S711.68 231.936 563.2 231.936z","p-id":"2621"}),createBaseVNode("path",{d:"M477.184 415.744l171.008 0 0 171.008-171.008 0 0-171.008Z","p-id":"2622"})],-1))),_hoisted_36={class:"chat-content-footer"},_hoisted_37={class:"max-w-[1000px] w-[90%] m-auto h-full flex items-center"};function _sfc_render$2(e,t,o,s,a,r){const n=resolveComponent("Expand"),i=resolveComponent("el-icon"),l=resolveComponent("Plus"),c=resolveComponent("Download"),d=resolveComponent("el-dropdown-item"),h=resolveComponent("el-dropdown-menu"),u=resolveComponent("el-dropdown"),p=resolveComponent("el-col"),_=resolveComponent("el-row"),f=resolveComponent("el-scrollbar"),m=resolveComponent("Loading"),y=resolveComponent("VMdPreview"),v=resolveComponent("el-button"),C=resolveComponent("Delete"),w=resolveComponent("CopyDocument"),g=resolveComponent("el-input"),S=resolveComponent("Promotion"),x=resolveDirective("loading");return withDirectives((openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",_hoisted_3$1,["mobile"===e.$route.params.device?(openBlock(),createElementBlock("div",_hoisted_4$1,[createVNode(i,{size:25,onClick:t[0]||(t[0]=t=>e.$emit("showAside"))},{default:withCtx((()=>[createVNode(n)])),_:1})])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_5$1,toDisplayString(["new","newChat"].includes(e.chatKey)?"鏂颁細璇濈獥鍙�":e.chatInfo.title),1),createBaseVNode("div",_hoisted_6,["mobile"===e.$route.params.device?(openBlock(),createBlock(i,{key:0,size:25,onClick:t[1]||(t[1]=t=>e.$emit("handleNewChat"))},{default:withCtx((()=>[createVNode(l)])),_:1})):createCommentVNode("",!0),s.mainStore.userInfo.isPay&&"mobile"!==e.$route.params.device?(openBlock(),createBlock(u,{key:1,style:{color:"var(--theme-text-color)"}},{dropdown:withCtx((()=>[createVNode(h,null,{default:withCtx((()=>[createVNode(d,{onClick:t[2]||(t[2]=e=>s.exportFile("json","text/json"))},{default:withCtx((()=>[createTextVNode("瀵煎嚭.json鏂囦欢")])),_:1}),createVNode(d,{onClick:t[3]||(t[3]=e=>s.exportFile("txt","text/plain"))},{default:withCtx((()=>[createTextVNode("瀵煎嚭.txt 鏂囨湰")])),_:1}),createVNode(d,{onClick:t[4]||(t[4]=e=>s.exportFile("md","text/plain"))},{default:withCtx((()=>[createTextVNode("瀵煎嚭.md 鏂囨。")])),_:1})])),_:1})])),default:withCtx((()=>[createVNode(i,{size:25},{default:withCtx((()=>[createVNode(c)])),_:1})])),_:1})):createCommentVNode("",!0)])])]),e.chatKey&&"new"!==e.chatKey?(openBlock(),createElementBlock("div",_hoisted_13,[createVNode(f,{ref:"scrollbarRef"},{default:withCtx((()=>[createBaseVNode("ul",_hoisted_14,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.messageList,((o,a)=>{var r,n,l,c;return openBlock(),createElementBlock("li",{key:o.id,class:normalizeClass(["message-list-item",{"is-user":"user"===o.role}])},[createBaseVNode("div",{class:normalizeClass(["avatar",{"is-mobile":"mobile"===e.$route.params.device}])},["user"===o.role?(openBlock(),createElementBlock("img",{key:0,class:"w-[100%] h-[100%]",src:s.mainStore.userInfo.head_img},null,8,_hoisted_15)):(openBlock(),createElementBlock("img",{key:1,class:"w-[60%] h-[60%]",src:`/img/role-images/${e.chatInfo.chat_role}.svg`},null,8,_hoisted_16))],2),createBaseVNode("div",_hoisted_17,[createBaseVNode("div",_hoisted_18,toDisplayString("user"===o.role?"":null==(r=s.mainStore.roleList.find((t=>t.role===e.chatInfo.chat_role)))?void 0:r.name)+" "+toDisplayString(s.timeFormat(o.sendTime)),1),createBaseVNode("div",_hoisted_19,[createBaseVNode("div",_hoisted_20,[o.messageError?(openBlock(),createElementBlock("div",_hoisted_24,[-1!==(null==(n=o.messageError)?void 0:n.indexOf("鐧诲綍"))?(openBlock(),createElementBlock("div",_hoisted_25,[_hoisted_26,createVNode(v,{class:"mt-[10px]",link:"",size:"large",type:"success",onClick:t[6]||(t[6]=t=>e.$emit("handleLogin"))},{default:withCtx((()=>[createTextVNode("绔嬪嵆鐧诲綍")])),_:1})])):-1!==(null==(l=o.messageError)?void 0:l.indexOf("鍏嶈垂娆℃暟"))?(openBlock(),createElementBlock("div",_hoisted_27,[_hoisted_28,createVNode(v,{class:"mt-[10px]",link:"",size:"large",type:"success",onClick:t[7]||(t[7]=t=>e.$router.push(`/${e.$route.params.device}/plan`))},{default:withCtx((()=>[createTextVNode("濂楅璁㈤槄")])),_:1})])):-1!==(null==(c=o.messageError)?void 0:c.indexOf("闈炴硶"))?(openBlock(),createElementBlock("div",_hoisted_29,[_hoisted_30,createVNode(v,{class:"mt-[10px]",link:"",size:"large",type:"success",onClick:s.reloadPage},{default:withCtx((()=>[createTextVNode("鍒锋柊椤甸潰")])),_:1},8,["onClick"])])):(openBlock(),createElementBlock("div",_hoisted_31,toDisplayString(o.messageError),1))])):(openBlock(),createElementBlock("div",_hoisted_21,[!o.content&&e.disabledInput?(openBlock(),createElementBlock("div",_hoisted_22,[createVNode(i,{class:"is-loading align-middle"},{default:withCtx((()=>[createVNode(m)])),_:1}),_hoisted_23])):(openBlock(),createBlock(y,{key:1,onCopyCodeSuccess:t[5]||(t[5]=t=>e.$message.success("澶嶅埗鎴愬姛")),text:o.content},null,8,["text"]))]))]),createBaseVNode("div",_hoisted_32,[e.disabledInput||o.messageError?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:"copy-icon-box",onClick:e=>s.handleDeleteMessage(o.id,a)},[createVNode(i,{size:14},{default:withCtx((()=>[createVNode(C)])),_:1})],8,_hoisted_33)),!o.messageError&&e.messageList.length-1!==a||!o.messageError&&!e.disabledInput?(openBlock(),createElementBlock("div",{key:1,class:"copy-icon-box",onClick:e=>s.copyText(o.content)},[createVNode(i,{size:14},{default:withCtx((()=>[createVNode(w)])),_:1})],8,_hoisted_34)):createCommentVNode("",!0),e.messageList.length-1===a&&e.disabledInput?(openBlock(),createElementBlock("div",{key:2,class:"copy-icon-box",onClick:t[8]||(t[8]=(...e)=>s.handleStop&&s.handleStop(...e))},[createVNode(i,{size:25,color:"#F56C6C"},{default:withCtx((()=>[_hoisted_35])),_:1})])):createCommentVNode("",!0)])])])],2)})),128))])])),_:1},512)])):(openBlock(),createElementBlock("div",_hoisted_7,[createBaseVNode("h1",{class:normalizeClass(["text-[30px] text-center text-[var(--theme-text-color)] font-bold pb-[20px]",{"pb-[10vh!important]":"mobile"!==e.$route.params.device}])},"灏廙鏅鸿兘鍔╂墜",2),createVNode(f,{class:"flex-1"},{default:withCtx((()=>[createBaseVNode("div",_hoisted_8,[createVNode(_,null,{default:withCtx((()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(s.mainStore.roleList,(t=>(openBlock(),createBlock(p,{span:8,class:normalizeClass(["role-col",{"is-mobile":"mobile"===e.$route.params.device}])},{default:withCtx((()=>[createBaseVNode("div",_hoisted_9,[createBaseVNode("div",{class:normalizeClass(["flex flex-col justify-center items-center w-[120px] h-[120px] roleBox",{"is-checked":e.chatInfo.chat_role===t.role}]),onClick:o=>e.chatInfo.chat_role=t.role},[createBaseVNode("img",{class:"role-avatar",src:`/img/role-images/${t.role}.svg`,alt:""},null,8,_hoisted_11),createBaseVNode("div",_hoisted_12,toDisplayString(t.name),1)],10,_hoisted_10)])])),_:2},1032,["class"])))),256))])),_:1})])])),_:1})])),createBaseVNode("div",_hoisted_36,[createBaseVNode("div",_hoisted_37,[createVNode(g,{type:"textarea",class:"h-[50px] send-message-input",modelValue:e.sendForm.sendMessage,"onUpdate:modelValue":t[9]||(t[9]=t=>e.sendForm.sendMessage=t),placeholder:"mobile"===e.$route.params.device?"璇疯緭鍏ユ秷鎭唴瀹癸紝鍥炶溅鍙戦€併€�":"璇疯緭鍏ユ秷鎭唴瀹癸紝鍚屾椂鎸変綇Shift + Enter鎹㈣銆�",rows:2,resize:"none",clearable:"",maxlength:1500,"show-word-limit":"",onKeydown:s.handleKeyDown},null,8,["modelValue","placeholder","onKeydown"]),createVNode(v,{class:"w-[50px!important] h-[50px!important] ml-[15px]",type:"primary",disabled:!e.sendForm.sendMessage||e.disabledInput,onClick:s.handleSubmit},{default:withCtx((()=>[createVNode(i,{size:20},{default:withCtx((()=>[createVNode(S)])),_:1})])),_:1},8,["disabled","onClick"])])])])),[[x,e.pageLoading]])}const ChatContent=_export_sfc(_sfc_main$2,[["render",_sfc_render$2],["__scopeId","data-v-491950a7"]]),ChatAside_vue_vue_type_style_index_0_scoped_fe8f7f83_lang="",_sfc_main$1={name:"ChatAside",components:{Delete:delete_default},setup(){const e=useMainStore(),{proxy:t}=getCurrentInstance(),o=useRouter(),s=useRoute(),a=reactive({chatsList:[],activeChatId:s.params.id});watchEffect((()=>{a.activeChatId=s.params.id}));const r=()=>__async(this,null,(function*(){const e=yield GetChatList();200===e.statusCode&&(a.chatsList=e.data)}));return e.userInfo.role&&r(),__spreadProps(__spreadValues({},toRefs(a)),{getChats:r,handleNewChat:()=>{e.waitSending((()=>{a.activeChatId=void 0,o.replace(`/${s.params.device}/chat/new`)}))},handleDeleteChat:n=>{e.waitSending((()=>{t.$confirm("鏄惁纭瑕佸垹闄よ浼氳瘽锛�","鍒犻櫎纭",{type:"error","button-size":"large"}).then((()=>__async(this,null,(function*(){200===(yield DeleteChats({conversation_id:n})).statusCode&&(yield r(),n.includes(a.activeChatId)&&o.replace(`/${s.params.device}/chat/new`),t.$message.success("鍒犻櫎鎴愬姛"))}))))}))},handleChangeChat:t=>{e.waitSending((()=>{o.replace(t)}))},handleClearChats:()=>{e.waitSending((()=>{t.$confirm("鎮ㄧ‘璁よ鍒犻櫎鎵€鏈夌殑浼氳瘽鍚楋紵","娓呯┖浼氳瘽",{type:"error"}).then((()=>__async(this,null,(function*(){200===(yield DeleteChats({conversation_id:a.chatsList.map((e=>e.conversation_id))})).statusCode&&(yield r(),yield o.replace(`/${s.params.device}/chat/new`),t.$message.success("鍒犻櫎鎴愬姛"))}))))}))}})}},_hoisted_1$1={class:"chat-aside"},_hoisted_2={class:"flex items-center w-full"},_hoisted_3={class:"w-[30px] h-[30px] avatar"},_hoisted_4=["src"],_hoisted_5={class:"flex-1 overflow-hidden text-ellipsis mr-[5px]"};function _sfc_render$1(e,t,o,s,a,r){const n=resolveComponent("el-button"),i=resolveComponent("Delete"),l=resolveComponent("el-icon"),c=resolveComponent("el-menu-item"),d=resolveComponent("el-menu"),h=resolveComponent("el-scrollbar");return openBlock(),createElementBlock("div",_hoisted_1$1,[createVNode(n,{class:"new-chat-btn",onClick:s.handleNewChat},{default:withCtx((()=>[createTextVNode("鏂扮獥鍙ｅ璇�")])),_:1},8,["onClick"]),createVNode(h,null,{default:withCtx((()=>[(openBlock(),createBlock(d,{"default-active":e.activeChatId,class:"chat-aside-menu",key:"new"===e.$route.params.id,onSelect:s.handleChangeChat},{default:withCtx((()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.chatsList,(e=>(openBlock(),createBlock(c,{index:e.conversation_id,key:e.conversation_id},{default:withCtx((()=>[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("img",{class:"w-[60%] h-[60%]",src:`/img/role-images/${e.chat_role}.svg`,alt:"role"},null,8,_hoisted_4)]),createBaseVNode("span",_hoisted_5,toDisplayString(e.title),1),createVNode(l,{size:"14",onClick:withModifiers((t=>s.handleDeleteChat([e.conversation_id])),["stop"])},{default:withCtx((()=>[createVNode(i)])),_:2},1032,["onClick"])])])),_:2},1032,["index"])))),128))])),_:1},8,["default-active","onSelect"]))])),_:1}),createVNode(n,{class:"new-chat-btn mt-[10px]",onClick:s.handleClearChats},{default:withCtx((()=>[createTextVNode("鍒犻櫎鎵€鏈変細璇�")])),_:1},8,["onClick"])])}const ChatAside=_export_sfc(_sfc_main$1,[["render",_sfc_render$1],["__scopeId","data-v-fe8f7f83"]]),chat_vue_vue_type_style_index_0_scoped_88feaee9_lang="",_sfc_main={name:"chat",components:{ChatAside:ChatAside,ChatContent:ChatContent},setup(){const e=useMainStore(),{proxy:t}=getCurrentInstance(),o=reactive({asideShow:!1});return onBeforeRouteUpdate((()=>{o.asideShow=!1})),__spreadValues({mainStore:e,getChats:()=>{t.$refs.chatAsideRef.getChats()},handleNewChat:()=>{t.$refs.chatAsideRef.handleNewChat()}},toRefs(o))}},_hoisted_1={class:"chat-content-box"};function _sfc_render(e,t,o,s,a,r){const n=resolveComponent("ChatAside"),i=resolveComponent("ChatContent");return openBlock(),createElementBlock("div",{class:"chat-container",key:s.mainStore.userInfo.role},["mobile"!==e.$route.params.device?(openBlock(),createBlock(n,{key:0,ref:"chatAsideRef"},null,512)):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(["mobile-aside",{active:e.asideShow}]),onClick:t[1]||(t[1]=t=>e.asideShow=!1)},[createVNode(n,{ref:"chatAsideRef",onClick:t[0]||(t[0]=withModifiers((()=>{}),["stop"]))},null,512)],2)),createBaseVNode("div",_hoisted_1,[createVNode(i,{onReloadList:s.getChats,onShowAside:t[2]||(t[2]=t=>e.asideShow=!0),onHandleNewChat:s.handleNewChat,onHandleLogin:t[3]||(t[3]=t=>e.$emit("handleLogin"))},null,8,["onReloadList","onHandleNewChat"])])])}const chat=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-88feaee9"]]);export{chat as default};